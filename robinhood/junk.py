import pandas as pd
import numpy as np
# we want a dict with {company : {2019: totaldiv, 2020: totaldiv}, company:{2019: totaldiv, 2020: totaldiv}}


div = {'2020-04-27': {'ticker': 'GE', 'amount': '0.55', 'rate': '0.0100000000', 'position': '55.00000000'}, '2020-04-30': {'ticker': 'SPHD', 'amount': '1.56', 'rate': '0.1561800000', 'position': '10.00000000'}, '2020-05-01': {'ticker': 'T', 'amount': '4.16', 'rate': '0.5200000000', 'position': '8.00000000'}, '2020-04-14': {'ticker': 'SDEM', 'amount': '0.30', 'rate': '0.0595000000', 'position': '5.00000000'}, '2020-04-15': {'ticker': 'USB', 'amount': '5.46', 'rate': '0.4200000000', 'position': '13.00000000'}, '2020-04-06': {'ticker': 'WMT', 'amount': '2.70', 'rate': '0.5400000000', 'position': '5.00000000'}, '2020-04-01': {'ticker': 'HPQ', 'amount': '1.59', 'rate': '0.1762000000', 'position': '9.00000000'}, '2020-03-12': {'ticker': 'MMM', 'amount': '1.47', 'rate': '1.4700000000', 'position': '1.00000000'}, '2020-03-02': {'ticker': 'INTC', 'amount': '1.65', 'rate': '0.3300000000', 'position': '5.00000000'}, '2020-03-10': {'ticker': 'IBM', 'amount': '11.34', 'rate': '1.6200000000', 'position': '7.00000000'}, '2020-02-13': {'ticker': 'SDEM', 'amount': '0.41', 'rate': '0.0815000000', 'position': '5.00000000'}, '2020-03-13': {'ticker': 'MET', 'amount': '2.20', 'rate': '0.4400000000', 'position': '5.00000000'}, '2020-02-18': {'ticker': 'LNT', 'amount': '0.76', 'rate': '0.3800000000', 'position': '2.00000000'}, '2020-01-27': {'ticker': 'GE', 'amount': '0.55', 'rate': '0.0100000000', 'position': '55.00000000'}, '2020-02-03': {'ticker': 'T', 'amount': '2.60', 'rate': '0.5200000000', 'position': '5.00000000'}, '2020-01-08': {'ticker': 'SDEM', 'amount': '0.41', 'rate': '0.0815000000', 'position': '5.00000000'}, '2020-01-15': {'ticker': 'USB', 'amount': '5.04', 'rate': '0.4200000000', 'position': '12.00000000'}, '2020-01-16': {'ticker': 'DIS', 'amount': '2.64', 'rate': '0.8800000000', 'position': '3.00000000'}, '2020-01-02': {'ticker': 'WMT', 'amount': '1.06', 'rate': '0.5300000000', 'position': '2.00000000'}, '2019-12-12': {'ticker': 'MMM', 'amount': '1.44', 'rate': '1.4400000000', 'position': '1.0000'}, '2019-12-10': {'ticker': 'IBM', 'amount': '11.34', 'rate': '1.6200000000', 'position': '7.00000000'}, '2019-12-02': {'ticker': 'INTC', 'amount': '1.58', 'rate': '0.3150000000', 'position': '5.0000'}, '2019-12-31': {'ticker': 'EAF', 'amount': '0.51', 'rate': '0.0850000000', 'position': '6.0000'}, '2019-11-27': {'ticker': 'ALSN', 'amount': '0.30', 'rate': '0.1500000000', 'position': '2.0000'}, '2019-11-14': {'ticker': 'DAL', 'amount': '3.22', 'rate': '0.4025000000', 'position': '8.0000'}, '2019-11-22': {'ticker': 'HSII', 'amount': '0.45', 'rate': '0.1500000000', 'position': '3.0000'}, '2019-11-13': {'ticker': 'SDEM', 'amount': '0.41', 'rate': '0.0815000000', 'position': '5.0000'}, '2019-12-13': {'ticker': 'MET', 'amount': '2.20', 'rate': '0.4400000000', 'position': '5.0000'}, '2019-11-01': {'ticker': 'T', 'amount': '1.53', 'rate': '0.5100000000', 'position': '3.0000'}, '2019-11-15': {'ticker': 'LNT', 'amount': '0.71', 'rate': '0.3550000000', 'position': '2.0000'}, '2019-10-21': {'ticker': 'BPT', 'amount': '1.00', 'rate': '0.3348170000', 'position': '3.0000'}, '2019-10-11': {'ticker': 'SDEM', 'amount': '0.41', 'rate': '0.0815000000', 'position': '5.0000'}, '2019-10-02': {'ticker': 'HPQ', 'amount': '0.48', 'rate': '0.1602000000', 'position': '3.0000'}, '2019-10-15': {'ticker': 'USB', 'amount': '5.04', 'rate': '0.4200000000', 'position': '12.0000'}, '2019-10-01': {'ticker': 'FHN', 'amount': '0.28', 'rate': '0.1400000000', 'position': '2.0000'}, '2019-10-25': {'ticker': 'GE', 'amount': '0.49', 'rate': '0.0100000000', 'position': '49.0000'}, '2019-09-10': {'ticker': 'IBM', 'amount': '11.34', 'rate': '1.6200000000', 'position': '7.0000'}, '2019-09-13': {'ticker': 'MET', 'amount': '2.20', 'rate': '0.4400000000', 'position': '5.0000'}, '2019-09-16': {'ticker': 'KRO', 'amount': '0.90', 'rate': '0.1800000000', 'position': '5.0000'}, '2019-09-30': {'ticker': 'EAF', 'amount': '0.51', 'rate': '0.0850000000', 'position': '6.0000'}, '2019-08-30': {'ticker': 'ALSN', 'amount': '0.30', 'rate': '0.1500000000', 'position': '2.0000'}, '2019-09-12': {'ticker': 'MMM', 'amount': '1.44', 'rate': '1.4400000000', 'position': '1.0000'}, '2019-08-15': {'ticker': 'DAL', 'amount': '2.01', 'rate': '0.4025000000', 'position': '5.0000'}, '2019-08-23': {'ticker': 'HSII', 'amount': '0.30', 'rate': '0.1500000000', 'position': '2.0000'}, '2019-09-03': {'ticker': 'INTC', 'amount': '1.58', 'rate': '0.3150000000', 'position': '5.0000'}, '2019-08-13': {'ticker': 'SDEM', 'amount': '0.36', 'rate': '0.0715000000', 'position': '5.0000'}, '2019-08-01': {'ticker': 'GIS', 'amount': '1.47', 'rate': '0.4900000000', 'position': '3.0000'}, '2019-07-22': {'ticker': 'BPT', 'amount': '1.65', 'rate': '0.5510500000', 'position': '3.0000'}, '2019-07-12': {'ticker': 'SDEM', 'amount': '0.36', 'rate': '0.0715000000', 'position': '5.0000'}, '2019-07-03': {'ticker': 'HPQ', 'amount': '0.48', 'rate': '0.1602000000', 'position': '3.0000'}, '2019-07-25': {'ticker': 'GE', 'amount': '0.25', 'rate': '0.0100000000', 'position': '25.0000'}, '2019-07-15': {'ticker': 'WDC', 'amount': '1.50', 'rate': '0.5000000000', 'position': '3.0000'}, '2019-06-27': {'ticker': 'GILD', 'amount': '0.63', 'rate': '0.6300000000', 'position': '1.0000'}, '2019-07-01': {'ticker': 'FHN', 'amount': '0.28', 'rate': '0.1400000000', 'position': '2.0000'}, '2019-06-13': {'ticker': 'MET', 'amount': '2.20', 'rate': '0.4400000000', 'position': '5.0000'}, '2019-06-28': {'ticker': 'EAF', 'amount': '0.51', 'rate': '0.0850000000', 'position': '6.0000'}, '2019-06-03': {'ticker': 'WMT', 'amount': '1.06', 'rate': '0.5300000000', 'position': '2.0000'}, '2019-05-31': {'ticker': 'ALSN', 'amount': '0.30', 'rate': '0.1500000000', 'position': '2.0000'}, '2019-06-10': {'ticker': 'IBM', 'amount': '8.10', 'rate': '1.6200000000', 'position': '5.0000'}, '2019-05-24': {'ticker': 'HSII', 'amount': '0.30', 'rate': '0.1500000000', 'position': '2.0000'}, '2019-05-13': {'ticker': 'SDEM', 'amount': '0.34', 'rate': '0.0687000000', 'position': '5.0000'}, '2019-05-23': {'ticker': 'DAL', 'amount': '1.75', 'rate': '0.3500000000', 'position': '5.0000'}, '2019-05-16': {'ticker': 'CALM', 'amount': '0.54', 'rate': '0.2720000000', 'position': '2.0000'}, '2019-05-15': {'ticker': 'LNT', 'amount': '2.84', 'rate': '0.3550000000', 'position': '8.0000'}, '2019-04-22': {'ticker': 'BPT', 'amount': '1.03', 'rate': '0.3449260000', 'position': '3.0000'}, '2019-05-01': {'ticker': 'T', 'amount': '0.51', 'rate': '0.5100000000', 'position': '1.0000'}, '2019-04-01': {'ticker': 'WMT', 'amount': '1.06', 'rate': '0.5300000000', 'position': '2.0000'}, '2019-04-15': {'ticker': 'USB', 'amount': '3.70', 'rate': '0.3700000000', 'position': '10.0000'}, '2019-04-25': {'ticker': 'GE', 'amount': '0.01', 'rate': '0.0100000000', 'position': '1.0000'}, '2019-03-22': {'ticker': 'DAL', 'amount': '1.75', 'rate': '0.3500000000', 'position': '5.0000'}, '2019-03-11': {'ticker': 'IBM', 'amount': '7.85', 'rate': '1.5700000000', 'position': '5.0000'}, '2019-02-15': {'ticker': 'LNT', 'amount': '4.26', 'rate': '0.3550000000', 'position': '12.0000'}}
print('to df!!')
df = pd.DataFrame.from_dict(div, orient='index')[['ticker', 'amount']].astype({'amount':'float'}).set_index(pd.to_datetime(df.index))
#df.index = pd.to_datetime(df.index)
div_summary = df.groupby([df.index.year, df.ticker]).sum()#.sort_values(['amount'], ascending=False)
print(div_summary)

print(div_summary.sum())


